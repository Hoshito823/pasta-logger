<!doctype html><html lang="ja"><head>
<meta charset="UTF-8" /><title>新規記録 - Pasta Logger</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="/src/style.css" />
</head><body class="min-h-screen bg-gray-50 text-gray-900">
<header class="sticky top-0 bg-white/70 backdrop-blur border-b">
  <nav class="mx-auto max-w-3xl px-4 py-3 flex items-center gap-3">
    <a href="/" class="font-semibold">Pasta Logger</a>
    <a href="/log-list.html" class="btn">履歴</a>
    <a href="/manage.html" class="btn">管理</a>
  </nav>
</header>

<main class="mx-auto max-w-3xl px-4 py-6 space-y-6">
  <h2 class="text-xl font-bold">新規記録</h2>
  <div id="auth"></div>

  <form id="logForm" class="card space-y-4" novalidate>
    <div>
      <label class="label">写真</label>
      <div class="space-y-2">
        <div class="flex gap-2">
          <button type="button" id="cameraBtn" class="btn flex-1">📷 カメラで撮影</button>
          <button type="button" id="galleryBtn" class="btn flex-1">🖼️ ギャラリーから選択</button>
        </div>
        <input type="file" id="photo" name="photo" accept="image/*" class="input hidden">
        <div id="photoPreview" class="hidden">
          <img id="previewImage" class="w-full max-w-xs h-auto rounded-lg border">
          <button type="button" id="removePhoto" class="btn text-sm mt-1">写真を削除</button>
        </div>
      </div>
    </div>

    <div><label class="label">パスタ名</label><input id="pastaName" name="pastaName" class="input" placeholder="ナスとアンチョビのペペロンチーノ"></div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
      <div><label class="label">カテゴリ</label><select id="recipe" name="recipe" class="input"></select></div>
      <div>
        <label class="label">麺 <span class="text-red-500">*</span></label>
        <select id="pasta" name="pasta" class="input" required></select>
        <button type="button" id="addNewPasta" class="btn text-xs mt-1 w-full">新しい麺を登録</button>
      </div>
      <div><label class="label">チーズ（複数可）</label><select id="cheese" name="cheese" class="input" multiple size="3"></select></div>
    </div>

    <!-- 茹で時間設定 -->
    <div>
      <label class="label">茹で時間</label>
      <div class="space-y-2">
        <!-- 分と秒の個別設定 -->
        <div class="flex items-center gap-2">
          <div class="flex items-center gap-1 flex-1">
            <button type="button" id="boilMinuteMinus" class="btn w-6 h-6 flex items-center justify-center p-0 text-xs">-</button>
            <input id="boilMinutes" type="number" min="0" max="9" value="8" class="input text-center w-12 text-sm">
            <button type="button" id="boilMinutePlus" class="btn w-6 h-6 flex items-center justify-center p-0 text-xs">+</button>
            <span class="text-xs text-gray-600">分</span>
          </div>
          <div class="flex items-center gap-1 flex-1">
            <button type="button" id="boilSecondMinus" class="btn w-6 h-6 flex items-center justify-center p-0 text-xs">-</button>
            <input id="boilSeconds" type="number" min="0" max="59" step="10" value="0" class="input text-center w-12 text-sm">
            <button type="button" id="boilSecondPlus" class="btn w-6 h-6 flex items-center justify-center p-0 text-xs">+</button>
            <span class="text-xs text-gray-600">秒</span>
          </div>
        </div>
        <!-- プリセットボタン -->
        <div class="grid grid-cols-3 gap-1 text-xs">
          <button type="button" class="boil-preset-btn btn py-1 px-1" data-minutes="6" data-seconds="30">6:30</button>
          <button type="button" class="boil-preset-btn btn py-1 px-1" data-minutes="7" data-seconds="0">7:00</button>
          <button type="button" class="boil-preset-btn btn py-1 px-1" data-minutes="8" data-seconds="0">8:00</button>
          <button type="button" class="boil-preset-btn btn py-1 px-1" data-minutes="9" data-seconds="0">9:00</button>
        </div>
        <!-- 隠しフィールド（従来の秒単位での値を保持） -->
        <input id="boilTime" name="boilTime" type="hidden" value="480">
      </div>
    </div>

    <!-- 水量・塩・茹で汁 -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
      <div><label class="label">水量(L)</label><input id="waterAmount" name="waterAmount" type="number" step="0.1" class="input" placeholder="1.0"></div>
      <div><label class="label">塩(g)</label><input id="saltAmount" name="saltAmount" type="number" step="1" class="input" placeholder="12"></div>
      <div><label class="label">茹で汁(お玉0.5)</label><input id="ladle" name="ladle" type="number" step="0.5" class="input" placeholder="1.0"></div>
    </div>
    
    <div class="text-sm text-gray-500" id="saltPercentage"></div>

    <!-- 調理工程記録セクション -->
    <div class="card space-y-4">
      <h3 class="font-semibold">調理工程記録</h3>

      <!-- タイマー表示 -->
      <div id="timerDisplay" class="hidden bg-blue-50 border border-blue-200 rounded-lg p-4 text-center">
        <div class="text-2xl font-bold text-blue-800" id="timerTime">準備中</div>
        <div class="text-sm text-blue-600 mt-1" id="timerStatus">調理開始準備</div>
      </div>

      <!-- 工程記録ボタン -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
        <button type="button" id="btnSauceStart" class="process-btn btn-outline border-orange-300 text-orange-700 hover:bg-orange-50 p-4 md:p-3 rounded-xl transition-all" data-process="sauce_start">
          <div class="text-base md:text-sm font-medium">① ソース開始</div>
          <div id="timeSauceStart" class="text-sm md:text-xs text-gray-500 mt-1">未記録</div>
        </button>

        <button type="button" id="btnPastaStart" class="process-btn btn-outline border-blue-300 text-blue-700 hover:bg-blue-50 p-4 md:p-3 rounded-xl transition-all" data-process="pasta_start">
          <div class="text-base md:text-sm font-medium">② 麺投入</div>
          <div id="timePastaStart" class="text-sm md:text-xs text-gray-500 mt-1">未記録</div>
        </button>

        <button type="button" id="btnPastaFinish" class="process-btn btn-outline border-blue-300 text-blue-700 hover:bg-blue-50 p-4 md:p-3 rounded-xl transition-all" data-process="pasta_finish">
          <div class="text-base md:text-sm font-medium">③ 茹で上がり</div>
          <div id="timePastaFinish" class="text-sm md:text-xs text-gray-500 mt-1">未記録</div>
        </button>

        <button type="button" id="btnSauceFinish" class="process-btn btn-outline border-orange-300 text-orange-700 hover:bg-orange-50 p-4 md:p-3 rounded-xl transition-all" data-process="sauce_finish">
          <div class="text-base md:text-sm font-medium">④ ソース完成</div>
          <div id="timeSauceFinish" class="text-sm md:text-xs text-gray-500 mt-1">未記録</div>
        </button>

        <button type="button" id="btnCombineStart" class="process-btn btn-outline border-purple-300 text-purple-700 hover:bg-purple-50 p-4 md:p-3 rounded-xl transition-all" data-process="combine_start">
          <div class="text-base md:text-sm font-medium">⑤ 合わせ開始</div>
          <div id="timeCombineStart" class="text-sm md:text-xs text-gray-500 mt-1">未記録</div>
        </button>

        <button type="button" id="btnCompletion" class="process-btn btn-outline border-green-300 text-green-700 hover:bg-green-50 p-4 md:p-3 rounded-xl transition-all" data-process="completion">
          <div class="text-base md:text-sm font-medium">⑥ 完成</div>
          <div id="timeCompletion" class="text-sm md:text-xs text-gray-500 mt-1">未記録</div>
        </button>
      </div>

      <!-- 時間分析表示（調理完了後） -->
      <div id="timeAnalysis" class="hidden bg-green-50 p-4 rounded-xl">
        <h4 class="font-semibold text-green-700 mb-2">時間分析</h4>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-3 text-sm">
          <div>
            <span class="text-gray-600">ソース待機:</span>
            <span id="analysisSauceWait" class="font-medium">-</span>
          </div>
          <div>
            <span class="text-gray-600">麺待機:</span>
            <span id="analysisPastaWait" class="font-medium">-</span>
          </div>
          <div>
            <span class="text-gray-600">合わせ時間:</span>
            <span id="analysisCombineDuration" class="font-medium">-</span>
          </div>
          <div>
            <span class="text-gray-600">総調理時間:</span>
            <span id="analysisTotalTime" class="font-medium text-blue-600">-</span>
          </div>
        </div>
      </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div>
        <label class="label">総合★</label>
        <div class="flex gap-1" id="overallStars">
          <button type="button" class="star-btn" data-rating="1">★</button>
          <button type="button" class="star-btn" data-rating="2">★</button>
          <button type="button" class="star-btn" data-rating="3">★</button>
          <button type="button" class="star-btn" data-rating="4">★</button>
          <button type="button" class="star-btn" data-rating="5">★</button>
        </div>
        <input id="overall" name="overall" type="hidden">
      </div>
      <div>
        <label class="label">堅さ</label>
        <div class="flex gap-2 flex-wrap" id="firmnessButtons">
          <button type="button" class="firmness-btn" data-rating="1">やわらかい</button>
          <button type="button" class="firmness-btn" data-rating="2">少しやわらかい</button>
          <button type="button" class="firmness-btn" data-rating="3">ちょうどよい</button>
          <button type="button" class="firmness-btn" data-rating="4">少しかたい</button>
          <button type="button" class="firmness-btn" data-rating="5">かたい</button>
        </div>
        <input id="firmness" name="firmness" type="hidden">
      </div>
    </div>

    <div><label class="label">レシピ参考</label>
      <input id="recipeReference" name="recipeReference" type="text" class="input" placeholder="参考にしたレシピのURL、書籍名、動画リンクなど">
    </div>

    <div><label class="label">メモ</label>
      <textarea id="feedback" name="feedback" rows="3" class="input" placeholder="少し硬すぎ／ソース開始が遅れた 等"></textarea>
    </div>

    <div class="flex gap-3">
      <button type="submit" class="btn btn-primary">保存</button>
      <a class="btn" href="/log-list.html">キャンセル</a>
    </div>
  </form>
</main>

<script type="module" src="/src/logNew.js"></script>
</body></html>
